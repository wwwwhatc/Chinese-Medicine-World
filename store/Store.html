<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中医商城</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f4f4f9;
            color: #333;
        }

        .navbar {
            background-color: #6B8E23;
        }

        .navbar .navbar-brand, .navbar .nav-link, .navbar .cart-count {
            color: white !important;
        }

        .navbar .nav-link:hover {
            background-color: #556B2F !important;
            border-radius: 5px;
        }

        .container {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .cart-modal .modal-body {
            max-height: 60vh;
            overflow-y: auto;
        }

        /* 自定义折叠图标 */
        .collapse-toggle::after {
            content: '\25BC';
            float: right;
            transition: transform 0.3s;
        }

        .collapse.show + .collapse-toggle::after {
            transform: rotate(180deg);
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">中医商城</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../store/Store.html">商城首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../home/home.html">返回首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link position-relative" href="#" data-bs-toggle="modal" data-bs-target="#cartModal">
                            购物车
                            <span class="badge bg-danger position-absolute top-0 start-100 translate-middle cart-count">0</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 主容器 -->
    <div class="container">
        <h1 class="text-center mb-5">中医商城</h1>

        <!-- 中药材 -->
        <section class="mb-5">
            <h2 class="text-success mb-4">
                <a class="collapse-toggle text-decoration-none" data-bs-toggle="collapse" href="#herbsSection" role="button" aria-expanded="true" aria-controls="herbsSection">
                    中药材
                </a>
            </h2>
            <div class="collapse show" id="herbsSection">
                <div class="row g-4">
                    <!-- 商品1 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/人参.jpg" class="card-img-top" alt="人参">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">人参</h5>
                                <p class="card-text">补气养血，滋补强身。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="人参" data-price="100">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品2 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/枸杞.jpg" class="card-img-top" alt="枸杞">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">枸杞</h5>
                                <p class="card-text">养肝明目，滋阴润肺。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="枸杞" data-price="50">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品3 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/当归.jpg" class="card-img-top" alt="当归">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">当归</h5>
                                <p class="card-text">补血活血，调经止痛。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="当归" data-price="80">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品4 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/黄芪.jpg" class="card-img-top" alt="黄芪">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">黄芪</h5>
                                <p class="card-text">益气固表，利尿消肿。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="黄芪" data-price="90">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品5 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/丹参.jpg" class="card-img-top" alt="丹参">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">丹参</h5>
                                <p class="card-text">活血化瘀，改善血液循环。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="丹参" data-price="70">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品6 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/桂枝.jpg" class="card-img-top" alt="桂枝">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">桂枝</h5>
                                <p class="card-text">解表散寒，调和营卫。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="桂枝" data-price="60">加入购物车</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 健康产品 -->
        <section class="mb-5">
            <h2 class="text-success mb-4">
                <a class="collapse-toggle text-decoration-none" data-bs-toggle="collapse" href="#healthProductsSection" role="button" aria-expanded="true" aria-controls="healthProductsSection">
                    健康产品
                </a>
            </h2>
            <div class="collapse show" id="healthProductsSection">
                <div class="row g-4">
                    <!-- 商品1 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/艾灸盒.jpg" class="card-img-top" alt="艾灸盒">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">艾灸盒</h5>
                                <p class="card-text">方便家庭使用，温经通络。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="艾灸盒" data-price="200">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品2 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/养生茶.jpg" class="card-img-top" alt="养生茶">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">养生茶</h5>
                                <p class="card-text">精选草本，健康好喝。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="养生茶" data-price="80">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品3 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/足浴盆.jpg" class="card-img-top" alt="足浴盆">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">足浴盆</h5>
                                <p class="card-text">促进血液循环，舒缓疲劳。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="足浴盆" data-price="150">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品4 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/按摩棒.jpg" class="card-img-top" alt="按摩棒">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">按摩棒</h5>
                                <p class="card-text">深层按摩，缓解肌肉酸痛。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="按摩棒" data-price="120">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品5 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/保温杯.jpg" class="card-img-top" alt="保温杯">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">保温杯</h5>
                                <p class="card-text">双层保温，保持饮品温度。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="保温杯" data-price="90">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品6 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/智能体重秤.jpg" class="card-img-top" alt="智能体重秤">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">智能体重秤</h5>
                                <p class="card-text">精准测量，数据同步手机。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="智能体重秤" data-price="180">加入购物车</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 书籍 -->
        <section class="mb-5">
            <h2 class="text-success mb-4">
                <a class="collapse-toggle text-decoration-none" data-bs-toggle="collapse" href="#booksSection" role="button" aria-expanded="true" aria-controls="booksSection">
                    书籍
                </a>
            </h2>
            <div class="collapse show" id="booksSection">
                <div class="row g-4">
                    <!-- 商品1 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《黄帝内经》.jpg" class="card-img-top" alt="《黄帝内经》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《黄帝内经》</h5>
                                <p class="card-text">中医经典著作，必读佳作。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《黄帝内经》" data-price="150">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品2 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《本草纲目》.jpg" class="card-img-top" alt="《本草纲目》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《本草纲目》</h5>
                                <p class="card-text">详细记载中药材知识。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《本草纲目》" data-price="120">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品3 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《伤寒杂病论》.jpg" class="card-img-top" alt="《伤寒杂病论》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《伤寒杂病论》</h5>
                                <p class="card-text">经典中医诊疗指南。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《伤寒杂病论》" data-price="130">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品4 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《中医基础理论》.jpg" class="card-img-top" alt="《中医基础理论》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《中医基础理论》</h5>
                                <p class="card-text">系统介绍中医基本理论。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《中医基础理论》" data-price="110">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品5 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《中药学》.jpg" class="card-img-top" alt="《中药学》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《中药学》</h5>
                                <p class="card-text">全面介绍中药的性质与应用。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《中药学》" data-price="140">加入购物车</button>
                            </div>
                        </div>
                    </div>
                    <!-- 商品6 -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100">
                            <img src="img/《针灸学》.jpg" class="card-img-top" alt="《针灸学》">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">《针灸学》</h5>
                                <p class="card-text">详细讲解针灸的理论与实践。</p>
                                <button class="btn btn-success mt-auto add-to-cart" data-name="《针灸学》" data-price="160">加入购物车</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 订单管理 -->
        <section class="mb-5">
            <h2 class="text-success mb-4">订单管理</h2>
            <ul class="list-group">
                <li class="list-group-item"><a href="#">查看我的购物车</a></li>
                <li class="list-group-item"><a href="#">管理订单</a></li>
                <li class="list-group-item"><a href="#">查看购买历史</a></li>
            </ul>
        </section>
    </div>

    <!-- 购物车模态框 -->
    <div class="modal fade cart-modal" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">购物车</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="关闭"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered" id="cartTable">
                        <thead>
                            <tr>
                                <th>商品名称</th>
                                <th>单价（元）</th>
                                <th>数量</th>
                                <th>小计（元）</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 购物车商品将动态添加到这里 -->
                        </tbody>
                    </table>
                    <div class="text-end">
                        <h5>总计: ¥<span id="totalPrice">0</span></h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">继续购物</button>
                    <button type="button" class="btn btn-primary" id="checkoutBtn">结算</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS 和依赖的Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 购物车数据结构
        let cart = {};

        // 在页面加载时恢复购物车数据
        window.addEventListener('load', () => {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartCount();
            }
        });

        // 更新购物车徽章
        function updateCartCount() {
            const count = Object.values(cart).reduce((acc, item) => acc + item.quantity, 0);
            document.querySelector('.cart-count').textContent = count;
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // 更新购物车模态框内容
        function updateCartModal() {
            const cartTableBody = document.querySelector('#cartTable tbody');
            cartTableBody.innerHTML = '';
            let total = 0;

            for (let key in cart) {
                const item = cart[key];
                const subtotal = item.price * item.quantity;
                total += subtotal;

                const row = document.createElement('tr');

                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>¥${item.price}</td>
                    <td>
                        <input type="number" min="1" class="form-control quantity-input" data-name="${item.name}" value="${item.quantity}">
                    </td>
                    <td>¥${subtotal}</td>
                    <td>
                        <button class="btn btn-danger btn-sm remove-item" data-name="${item.name}">移除</button>
                    </td>
                `;
                cartTableBody.appendChild(row);
            }

            document.getElementById('totalPrice').textContent = total.toFixed(2);
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // 添加商品到购物车
        document.querySelectorAll('.add-to-cart').forEach(button => {
            button.addEventListener('click', () => {
                const name = button.getAttribute('data-name');
                const price = parseFloat(button.getAttribute('data-price'));

                if (cart[name]) {
                    cart[name].quantity += 1;
                } else {
                    cart[name] = { name, price, quantity: 1 };
                }

                updateCartCount();
                alert(`${name} 已加入购物车！`);
            });
        });

        // 监听购物车模态框事件
        const cartModal = document.getElementById('cartModal');
        cartModal.addEventListener('show.bs.modal', updateCartModal);

        // 更新数量
        document.getElementById('cartTable').addEventListener('change', (e) => {
            if (e.target.classList.contains('quantity-input')) {
                const name = e.target.getAttribute('data-name');
                const quantity = parseInt(e.target.value);

                if (quantity > 0) {
                    cart[name].quantity = quantity;
                } else {
                    delete cart[name];
                }

                updateCartCount();
                updateCartModal();
            }
        });

        // 移除商品
        document.getElementById('cartTable').addEventListener('click', (e) => {
            if (e.target.classList.contains('remove-item')) {
                const name = e.target.getAttribute('data-name');
                delete cart[name];
                updateCartCount();
                updateCartModal();
            }
        });

        // 结算按钮
        document.getElementById('checkoutBtn').addEventListener('click', () => {
            if (Object.keys(cart).length === 0) {
                alert('购物车为空！');
                return;
            }
            // 这里可以添加结算逻辑，如跳转到支付页面
            alert('结算功能尚未实现。');
        });
    </script>
</body>
</html>
